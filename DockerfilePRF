FROM toolbox.sia.eu/docker-pagopa/performance-test-base-image:1.0.0

ENV http_proxy=http://csproxy:8080
ENV https_proxy=http://csproxy:8080
ENV no_proxy=toolbox.sia.eu

#FROM alpine:latest
#
##Add bash
#RUN apk add --no-cache bash
##INSTALL k6
#RUN wget https://github.com/grafana/k6/releases/download/v0.47.0/k6-v0.47.0-linux-amd64.tar.gz
#RUN	tar xzf k6-v0.47.0-linux-amd64.tar.gz
#RUN	mv k6-v0.47.0-linux-amd64/k6 /usr/local/bin
#RUN	rm -rf k6-v0.47.0-linux-amd64*

#add arguments
ARG debugEnabled
ARG rampa
ARG blacklist

# add k6 script 
ADD src/perf-test test/src/perf-test
ADD startPerfTest.sh test/startPerfTest.sh

#set working directory
WORKDIR /test

RUN chmod +x startPerfTest.sh

ENTRYPOINT ["./startPerfTest.sh", debugEnabled, rampa, blacklist]

#CMD ["/bin/bash"]